(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1176:(e,t,n)=>{Promise.resolve().then(n.bind(n,8800))},8800:(e,t,n)=>{"use strict";n.d(t,{default:()=>r});var l=n(5155),s=n(2115),a=n(5695),i=n(6766);function o(){let e=(0,a.useRouter)(),[t,n]=(0,s.useState)(""),[o,r]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1),[m,u]=(0,s.useState)(null),[h,x]=(0,s.useState)({}),[f,p]=(0,s.useState)(null),b=(e,t)=>{x(n=>{let l=Math.max(0,(n[e]||0)+t);return{...n,[e]:l}})},g=async()=>{d(!0),u(null);try{let e=await fetch("https://safe-macaque-83.hasura.app/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json",...""},body:JSON.stringify({query:"\n      query GetMenuItemsByLocale($nomeLocale: String!) {\n        locali(where: {nome_locale: {_eq: $nomeLocale}}) {\n          nome_locale\n          menu {\n            uuid\n            menu_sezioni {\n              uuid\n              nome\n              menu_items {\n                uuid\n                nome\n                tipologia\n                descrizione\n                prezzo\n              }\n            }\n          }\n        }\n      }\n    ",variables:{nomeLocale:t}})}),n=await e.json();r(n.data)}catch(e){console.error(e),u("Errore durante il fetch")}finally{d(!1)}},j=()=>{if(!o)return 0;let e=0;return o.locali.forEach(t=>t.menu.forEach(t=>t.menu_sezioni.forEach(t=>t.menu_items.forEach(t=>{let n=h[t.uuid]||0;e+=t.prezzo*n})))),e};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"p-4 max-w-md mx-auto bg-white min-h-screen",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold mb-4 text-center",children:"Men\xf9"}),(0,l.jsxs)("div",{className:"mb-4 flex gap-2",children:[(0,l.jsx)("input",{type:"text",placeholder:"Inserisci nome locale",value:t,onChange:e=>n(e.target.value),className:"border p-2 flex-1 rounded"}),(0,l.jsx)("button",{onClick:g,className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",children:"Cerca"})]}),c&&(0,l.jsx)("p",{children:"Caricamento..."}),m&&(0,l.jsx)("p",{className:"text-red-500",children:m}),o&&0===o.locali.length&&(0,l.jsx)("p",{children:"Nessun locale trovato."}),o&&(0,l.jsx)("div",{className:"flex gap-3 overflow-x-auto mb-4",children:(()=>{if(!o)return[];let e=new Set;return f?o.locali.some(e=>e.menu.some(e=>e.menu_sezioni.some(e=>e.menu_items.some(e=>e.tipologia===f))))&&e.add(f):o.locali.forEach(t=>t.menu.forEach(t=>t.menu_sezioni.forEach(t=>t.menu_items.forEach(t=>e.add(t.tipologia))))),Array.from(e)})().map(e=>(0,l.jsx)("button",{onClick:()=>p(e===f?null:e),className:"flex flex-col items-center px-4 py-2 rounded-full border ".concat(f===e?"bg-blue-500 text-white border-blue-500":"bg-white text-gray-700"),children:(0,l.jsx)("span",{className:"text-sm",children:e})},e))}),o&&o.locali.map(e=>(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-3",children:e.nome_locale}),e.menu.map(e=>(0,l.jsx)("div",{children:e.menu_sezioni.map(e=>(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h3",{className:"text-lg font-medium mb-2",children:e.nome}),(0,l.jsx)("div",{className:"flex flex-col gap-4",children:e.menu_items.filter(e=>!f||e.tipologia===f).map(e=>(0,l.jsxs)("div",{className:"flex items-center gap-3 border rounded-lg shadow p-2",children:[(0,l.jsx)(i.default,{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/7/71/Meet_Truffle%21.jpg/800px-Meet_Truffle%21.jpg",alt:e.nome,width:80,height:80,className:"object-cover rounded-md"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"font-semibold",children:e.nome}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:e.descrizione}),(0,l.jsxs)("p",{className:"font-medium mt-1",children:["€",e.prezzo.toFixed(2)]})]}),(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)("button",{onClick:()=>b(e.uuid,-1),className:"w-8 h-8 flex items-center justify-center border rounded-full",children:"-"}),(0,l.jsx)("span",{children:h[e.uuid]||0}),(0,l.jsx)("button",{onClick:()=>b(e.uuid,1),className:"w-8 h-8 flex items-center justify-center border rounded-full bg-green-500 text-white",children:"+"})]})]},e.uuid))})]},e.uuid))},e.uuid))]},e.nome_locale))]}),o&&(0,l.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg p-4",children:(0,l.jsxs)("div",{className:"max-w-md mx-auto flex justify-between items-center",children:[(0,l.jsx)("span",{className:"font-semibold text-lg",children:"Totale ordine:"}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsxs)("span",{className:"font-bold text-xl text-green-600",children:["€",j().toFixed(2)]}),(0,l.jsx)("button",{onClick:()=>{if(!o||0===j())return;let t=[];o.locali.forEach(e=>e.menu.forEach(e=>e.menu_sezioni.forEach(e=>e.menu_items.forEach(e=>{let n=h[e.uuid]||0;n>0&&t.push({uuid:e.uuid,nome:e.nome,prezzo:e.prezzo,quantita:n})}))));let n={items:t,total:j()};localStorage.setItem("orderData",JSON.stringify(n)),e.push("/checkout")},disabled:0===j(),className:"bg-green-500 text-white px-4 py-2 rounded-lg ".concat(0===j()?"opacity-50 cursor-not-allowed":"hover:bg-green-600"),children:"Ordina"})]})]})})]})}function r(){return(0,l.jsx)(o,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[212,441,684,358],()=>t(1176)),_N_E=e.O()}]);